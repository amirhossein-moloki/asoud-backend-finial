#!/usr/bin/env python3
"""
ุงุณฺฉุฑูพุช ฺฉุงูู ุจุฑุง ูพุฑ ฺฉุฑุฏู ุฏุชุงุจุณ Asoud
Complete Database Seeder for Asoud Platform
"""
import os
import sys
import django
import uuid
import random
from datetime import datetime, timedelta
from decimal import Decimal

# Setup Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings.development')
os.environ['USE_SQLITE'] = 'true'  # Force SQLite for development
django.setup()

from django.db import transaction
from django.contrib.auth import get_user_model
from apps.region.models import Country, Province, City
from apps.category.models import Group, Category, SubCategory
from apps.market.models import Market, MarketLocation, MarketContact, MarketSchedule
from apps.item.models import Item, ItemImage
from apps.users.models import User

print("="*80)
print("๐ ุงุณฺฉุฑูพุช ฺฉุงูู ูพุฑ ฺฉุฑุฏู ุฏุชุงุจุณ Asoud")
print("="*80)
print()

def create_regions():
    """ุงุฌุงุฏ ุฏุงุฏูโูุง ููุทููโุง ฺฉุงูู"""
    print("1๏ธโฃ  ุงุฌุงุฏ ุฏุงุฏูโูุง ููุทููโุง...")
    print("-" * 50)
    
    # ุงุฌุงุฏ ุงุฑุงู
    country, created = Country.objects.get_or_create(name='ุงุฑุงู')
    print(f"โ ฺฉุดูุฑ: {country.name} (ID: {country.id})")
    
    # ุงุณุชุงูโูุง ู ุดูุฑูุง ุงุฑุงู
    iran_data = {
        'ุชูุฑุงู': [
            'ุชูุฑุงู', 'ฺฉุฑุฌ', 'ูุฑุงูู', 'ุฏูุงููุฏ', 'ุฑูุฏูู', 'ุดูุฑุงุฑ', 'ุงุณูุงูุดูุฑ', 
            'ูพุงฺฉุฏุดุช', 'ูุฑูุฒฺฉูู', 'ุฑ', 'ููุงุฑุฏ', 'ูุฏุณ', 'ุจูุงุฑุณุชุงู'
        ],
        'ุงุตููุงู': [
            'ุงุตููุงู', 'ฺฉุงุดุงู', 'ูุฌูโุขุจุงุฏ', 'ุฎููโุดูุฑ', 'ุดุงููโุดูุฑ', 'ููุงูุฑุฌุงู',
            'ููุฌุงู', 'ูุจุงุฑฺฉู', 'ูุทูุฒ', 'ุงุฑุฏุณุชุงู', 'ูุงู', 'ุชุฑุงู ู ฺฉุฑูู'
        ],
        'ูุงุฑุณ': [
            'ุดุฑุงุฒ', 'ูุฑูุฏุดุช', 'ุฌูุฑู', 'ฺฉุงุฒุฑูู', 'ูุงุฑ', 'ุขุจุงุฏู', 'ูุณุง', 'ุฏุงุฑุงุจ',
            'ูุงุฑุณุชุงู', 'ุงุณุชูุจุงู', 'ูโุฑุฒ', 'ูุฑุงุดุจูุฏ'
        ],
        'ุฎุฑุงุณุงู ุฑุถู': [
            'ูุดูุฏ', 'ูุดุงุจูุฑ', 'ุณุจุฒูุงุฑ', 'ููฺุงู', 'ฺฉุงุดูุฑ', 'ุชุฑุจุช ุญุฏุฑู',
            'ุชุฑุจุช ุฌุงู', 'ฺูุงุฑุงู', 'ฺฉูุงุช', 'ุฏุฑฺฏุฒ', 'ูุฑูุงู', 'ุฎูุงู'
        ],
        'ุขุฐุฑุจุงุฌุงู ุดุฑู': [
            'ุชุจุฑุฒ', 'ูุฑุงุบู', 'ูุฑูุฏ', 'ูุงูู', 'ุณุฑุงุจ', 'ุจูุงุจ', 'ุงูุฑ', 'ูุดุชุฑูุฏ',
            'ุดุจุณุชุฑ', 'ฺฉูุจุฑ', 'ูุฑุฒูุงู', 'ูุฑุณ'
        ],
        'ุฎูุฒุณุชุงู': [
            'ุงููุงุฒ', 'ุฏุฒููู', 'ุขุจุงุฏุงู', 'ุฎุฑูุดูุฑ', 'ุงูุฏูุดฺฉ', 'ุดูุดุชุฑ', 'ูุณุฌุฏุณููุงู',
            'ุงุฐู', 'ุจูุฏุฑ ูุงูุดูุฑ', 'ุฑุงููุฑูุฒ', 'ูุงู', 'ููุฒู'
        ],
        'ูุงุฒูุฏุฑุงู': [
            'ุณุงุฑ', 'ุจุงุจู', 'ุขูู', 'ูุงุฆูโุดูุฑ', 'ุจุงุจูุณุฑ', 'ููุดูุฑ', 'ฺุงููุณ',
            'ุชูฺฉุงุจู', 'ุฑุงูุณุฑ', 'ูฺฉุง', 'ูุฑุฏููฺฉูุงุฑ', 'ฺฉูุงุฑุฏุดุช'
        ],
        'ฺฏูุงู': [
            'ุฑุดุช', 'ุงูุฒู', 'ูุงูุฌุงู', 'ููฺฏุฑูุฏ', 'ุฑูุฏุณุฑ', 'ุขุณุชุงุฑุง', 'ูููู',
            'ุตููุนูโุณุฑุง', 'ุฑูุฏุจุงุฑ', 'ุชุงูุด', 'ูุงุณุงู', 'ุดูุช'
        ],
        'ฺฉุฑูุงู': [
            'ฺฉุฑูุงู', 'ุฑูุณูุฌุงู', 'ุณุฑุฌุงู', 'ุฒุฑูุฏ', 'ุจู', 'ุฌุฑูุช', 'ุดูุฑุจุงุจฺฉ',
            'ฺฉูููุฌ', 'ุจุฑุฏุณุฑ', 'ููุนู ฺฏูุฌ', 'ุนูุจุฑุขุจุงุฏ', 'ุฑุงุจุฑ'
        ],
        'ุฒุฏ': [
            'ุฒุฏ', 'ูุจุฏ', 'ุงุฑุฏฺฉุงู', 'ุจุงูู', 'ููุฑุฒ', 'ุงุจุฑฺฉูู', 'ุชูุช',
            'ูุฑุงุช', 'ุจูุงุจุงุฏ', 'ุงุดฺฉุฐุฑ', 'ุฎุงุชู', 'ุจูุฏุฑุนุจุงุณ'
        ],
        'ฺฉุฑูุงูุดุงู': [
            'ฺฉุฑูุงูุดุงู', 'ุงุณูุงูโุขุจุงุฏ ุบุฑุจ', 'ฺฉูฺฏุงูุฑ', 'ูุฑุณู', 'ุตุญูู', 'ูุตุฑุดุฑู',
            'ุณุฑูพู ุฐูุงุจ', 'ฺฏูุงู ุบุฑุจ', 'ุฏุงูุงูู', 'ุซูุงุซ ุจุงุจุงุฌุงู', 'ุฌูุงูุฑูุฏ'
        ],
        'ูุฑุณุชุงู': [
            'ุฎุฑูโุขุจุงุฏ', 'ุจุฑูุฌุฑุฏ', 'ุฏูุฑูุฏ', 'ฺฉููุฏุดุช', 'ุงูฺฏูุฏุฑุฒ', 'ููุฑุขุจุงุฏ',
            'ุงุฒูุง', 'ุณูุณูู', 'ุฏููุงู', 'ุฑููุดฺฉุงู', 'ูพูโุฏุฎุชุฑ'
        ],
        'ููุฏุงู': [
            'ููุฏุงู', 'ููุงุฑ', 'ููุงููุฏ', 'ุชูุณุฑฺฉุงู', 'ฺฉุจูุฏุฑุงููฺฏ', 'ุจูุงุฑ',
            'ุฑุฒู', 'ูุงููู', 'ุงุณุฏุขุจุงุฏ', 'ูุฑูู', 'ุณุฑุงุจ'
        ]
    }
    
    total_cities = 0
    for province_name, cities in iran_data.items():
        province, created = Province.objects.get_or_create(
            name=province_name,
            country=country
        )
        print(f"  {'โ' if created else 'โ'} ุงุณุชุงู: {province_name}")
        
        for city_name in cities:
            city, created = City.objects.get_or_create(
                name=city_name,
                province=province
            )
            total_cities += 1
    
    print(f"โ ูุฌููุน: {Province.objects.count()} ุงุณุชุงูุ {total_cities} ุดูุฑ")
    print()

def create_categories():
    """ุงุฌุงุฏ ุฏุณุชูโุจูุฏโูุง ฺฉุงูู"""
    print("2๏ธโฃ  ุงุฌุงุฏ ุฏุณุชูโุจูุฏโูุง...")
    print("-" * 50)
    
    categories_data = {
        'ุบุฐุง ู ููุดุฏู': {
            'market_fee': 50000,
            'categories': {
                'ุฑุณุชูุฑุงู': {
                    'market_fee': 55000,
                    'subcategories': [
                        'ุฑุณุชูุฑุงู ุงุฑุงู', 'ุฑุณุชูุฑุงู ูุฑูฺฏ', 'ุฑุณุชูุฑุงู ฺู',
                        'ุฑุณุชูุฑุงู ุงุชุงูุง', 'ุฑุณุชูุฑุงู ูฺฉุฒฺฉ', 'ุฑุณุชูุฑุงู ฺุงูพู',
                        'ุฑุณุชูุฑุงู ุชุฑฺฉ', 'ุฑุณุชูุฑุงู ุนุฑุจ', 'ุฑุณุชูุฑุงู ููุฏ'
                    ]
                },
                'ูุณุช ููุฏ': {
                    'market_fee': 45000,
                    'subcategories': [
                        'ุจุฑฺฏุฑ', 'ูพุชุฒุง', 'ุณุงูุฏูฺ', 'ุณูุฎุงุฑ', 'ูุงุช ุฏุงฺฏ',
                        'ฺฉุจุงุจ ุชุฑฺฉ', 'ุดุงูุฑูุง', 'ูุงูุงูู', 'ุณูุด'
                    ]
                },
                'ฺฉุงูู': {
                    'market_fee': 35000,
                    'subcategories': [
                        'ฺฉุงูู ูุฏุฑู', 'ฺฉุงูู ุณูุช', 'ฺฉุงูู ฺฉุชุงุจ', 'ููููโุฎุงูู',
                        'ฺฉุงูู ุงูุชุฑูุช', 'ฺฉุงูู ุจุงุฒ'
                    ]
                },
                'ุดุฑู ู ููุงุฏ': {
                    'market_fee': 40000,
                    'subcategories': [
                        'ุดุฑู ุฎุดฺฉ', 'ุดุฑู ุชุฑ', 'ฺฉฺฉ ู ฺฉููฺู', 'ุจุณุชู',
                        'ุฏุณุฑ', 'ุดฺฉูุงุช', 'ุขุจูุจุงุช'
                    ]
                },
                'ุณููพุฑูุงุฑฺฉุช': {
                    'market_fee': 30000,
                    'subcategories': [
                        'ููุงุฏ ุบุฐุง', 'ููุดุฏู', 'ููู ู ุณุจุฒ', 'ูุจูุงุช',
                        'ฺฏูุดุช ู ูุฑุบ', 'ูุงู ู ุดุฑู'
                    ]
                }
            }
        },
        'ูพูุดุงฺฉ ู ูุฏ': {
            'market_fee': 40000,
            'categories': {
                'ูุจุงุณ ูุฑุฏุงูู': {
                    'market_fee': 35000,
                    'subcategories': [
                        'ุชโุดุฑุช', 'ูพุฑุงูู', 'ุดููุงุฑ', 'ฺฉุช ู ุดููุงุฑ',
                        'ูุจุงุณ ูุฑุฒุด', 'ูุจุงุณ ุฒุฑ', 'ูุจุงุณ ูุฌูุณ'
                    ]
                },
                'ูุจุงุณ ุฒูุงูู': {
                    'market_fee': 45000,
                    'subcategories': [
                        'ูุงูุชู', 'ุดููุงุฑ', 'ุชููฺฉ', 'ูพุงูุชู', 'ูุจุงุณ ูุฌูุณ',
                        'ูุจุงุณ ูุฑุฒุด', 'ูุจุงุณ ุฒุฑ', 'ูุจุงุณ ุจุงุฑุฏุงุฑ'
                    ]
                },
                'ฺฉูุด': {
                    'market_fee': 50000,
                    'subcategories': [
                        'ฺฉูุด ูุฑุฏุงูู', 'ฺฉูุด ุฒูุงูู', 'ฺฉูุด ุจฺฺฏุงูู', 'ฺฉูุด ูุฑุฒุด',
                        'ฺฉูุด ุฑุณู', 'ฺฉูุด ฺฉุชุงู', 'ุตูุฏู'
                    ]
                },
                'ฺฉู ู ฺฉููู': {
                    'market_fee': 30000,
                    'subcategories': [
                        'ฺฉู ุฏุณุช', 'ฺฉููู ูพุดุช', 'ฺฉู ููพโุชุงูพ', 'ฺฉู ูุฏุฑุณู',
                        'ฺฉู ูุณุงูุฑุช', 'ฺฉู ูุฑุฒุด'
                    ]
                }
            }
        },
        'ุฏุฌุชุงู ู ุงูฺฉุชุฑููฺฉ': {
            'market_fee': 60000,
            'categories': {
                'ููุจุงู ู ุชุจูุช': {
                    'market_fee': 70000,
                    'subcategories': [
                        'ฺฏูุด ููุดููุฏ', 'ุชุจูุช', 'ููุงุฒู ุฌุงูุจ ููุจุงู',
                        'ูุงุจ ู ูุญุงูุธ', 'ุดุงุฑฺุฑ', 'ูุฏุณุช'
                    ]
                },
                'ฺฉุงููพูุชุฑ': {
                    'market_fee': 80000,
                    'subcategories': [
                        'ููพโุชุงูพ', 'ฺฉุงููพูุชุฑ ุฑููุฒ', 'ูุงูุชูุฑ', 'ฺฉุจูุฑุฏ ู ูุงูุณ',
                        'ุงุณูพฺฉุฑ', 'ูุจโฺฉู', 'ูพุฑูุชุฑ'
                    ]
                },
                'ููุงุฒู ุฎุงูฺฏ': {
                    'market_fee': 100000,
                    'subcategories': [
                        'ุฎฺุงู ู ูุฑุฒุฑ', 'ูุงุดู ูุจุงุณุดู', 'ุฌุงุฑูุจุฑู',
                        'ุงุฌุงู ฺฏุงุฒ', 'ูุงฺฉุฑููู', 'ฺฉููุฑ'
                    ]
                }
            }
        },
        'ุฎุงูู ู ุขุดูพุฒุฎุงูู': {
            'market_fee': 45000,
            'categories': {
                'ูุจููุงู': {
                    'market_fee': 60000,
                    'subcategories': [
                        'ูุจู ุฑุงุญุช', 'ูุฒ ู ุตูุฏู', 'ฺฉูุฏ', 'ุชุฎุช ุฎูุงุจ',
                        'ูุฒ ููุงุฑุฎูุฑ', 'ูุฒ ฺฉุงุฑ', 'ููุณู ฺฉุชุงุจ'
                    ]
                },
                'ููุงุฒู ุขุดูพุฒุฎุงูู': {
                    'market_fee': 35000,
                    'subcategories': [
                        'ุธุฑูู', 'ููุงุฒู ูพุฎุช ู ูพุฒ', 'ฺุงูู ู ูุงุดู',
                        'ุงุจุฒุงุฑ ุขุดูพุฒ', 'ูุฎููุทโฺฉู', 'ุขุจูููโฺฏุฑ'
                    ]
                },
                'ุฏฺฉูุฑุงุณูู': {
                    'market_fee': 40000,
                    'subcategories': [
                        'ุชุงุจูู', 'ูุฑุด', 'ูพุฑุฏู', 'ฺฏูุฏุงู', 'ุขูู',
                        'ุณุงุนุช ุฏูุงุฑ', 'ุดูุน', 'ุนฺฉุณ'
                    ]
                }
            }
        },
        'ูุฑุฒุด ู ุชูุฑุญ': {
            'market_fee': 50000,
            'categories': {
                'ูุฑุฒุด': {
                    'market_fee': 60000,
                    'subcategories': [
                        'ูุจุงุณ ูุฑุฒุด', 'ฺฉูุด ูุฑุฒุด', 'ุชุฌูุฒุงุช ูุฑุฒุด',
                        'ูุฒูู', 'ุทูุงุจ', 'ุชููพ'
                    ]
                },
                'ุชูุฑุญ': {
                    'market_fee': 40000,
                    'subcategories': [
                        'ุจุงุฒโูุง ูฺฉุฑ', 'ูพุงุฒู', 'ุนุฑูุณฺฉ', 'ุงุณุจุงุจโุจุงุฒ',
                        'ฺฉุชุงุจ', 'ูุฌูู', 'ุณโุฏ ู ุฏโูโุฏ'
                    ]
                }
            }
        }
    }
    
    for group_name, group_data in categories_data.items():
        group, created = Group.objects.get_or_create(
            title=group_name,
            defaults={'market_fee': group_data['market_fee']}
        )
        print(f"  {'โ' if created else 'โ'} ฺฏุฑูู: {group_name}")
        
        for category_name, category_data in group_data['categories'].items():
            category, created = Category.objects.get_or_create(
                title=category_name,
                group=group,
                defaults={'market_fee': category_data['market_fee']}
            )
            print(f"    {'โ' if created else 'โ'} ุฏุณุชู: {category_name}")
            
            for subcategory_name in category_data['subcategories']:
                subcategory, created = SubCategory.objects.get_or_create(
                    title=subcategory_name,
                    category=category,
                    defaults={'market_fee': category_data['market_fee'] * 0.8}  # 80% of category fee
                )
    
    print(f"โ ูุฌููุน: {Group.objects.count()} ฺฏุฑููุ {Category.objects.count()} ุฏุณุชูุ {SubCategory.objects.count()} ุฒุฑุฏุณุชู")
    print()

def create_sample_users():
    """ุงุฌุงุฏ ฺฉุงุฑุจุฑุงู ููููู - ุญุฐู ุดุฏู ุจู ุฏูู ูุดฺฉู migration"""
    print("3๏ธโฃ  ุงุฌุงุฏ ฺฉุงุฑุจุฑุงู ููููู...")
    print("-" * 50)
    print("โ๏ธ  ุจุฎุด ฺฉุงุฑุจุฑุงู ุจู ุฏูู ูุดฺฉู migration ุญุฐู ุดุฏ")
    print("โ ูโุชูุงูุฏ ุจุนุฏุงู ุงุฒ Django admin ุงุณุชูุงุฏู ฺฉูุฏ")
    print()

def create_sample_markets():
    """ุงุฌุงุฏ ุจุงุฒุงุฑูุง ููููู - ุญุฐู ุดุฏู ุจู ุฏูู ูุงุฒ ุจู ฺฉุงุฑุจุฑ"""
    print("4๏ธโฃ  ุงุฌุงุฏ ุจุงุฒุงุฑูุง ููููู...")
    print("-" * 50)
    print("โ๏ธ  ุจุฎุด ุจุงุฒุงุฑูุง ุจู ุฏูู ูุงุฒ ุจู ฺฉุงุฑุจุฑ ุญุฐู ุดุฏ")
    print("โ ูโุชูุงูุฏ ุจุนุฏุงู ุงุฒ Django admin ุงุณุชูุงุฏู ฺฉูุฏ")
    print()

def create_sample_products():
    """ุงุฌุงุฏ ูุญุตููุงุช ููููู - ุญุฐู ุดุฏู ุจู ุฏูู ูุงุฒ ุจู ุจุงุฒุงุฑ"""
    print("5๏ธโฃ  ุงุฌุงุฏ ูุญุตููุงุช ููููู...")
    print("-" * 50)
    print("โ๏ธ  ุจุฎุด ูุญุตููุงุช ุจู ุฏูู ูุงุฒ ุจู ุจุงุฒุงุฑ ุญุฐู ุดุฏ")
    print("โ ูโุชูุงูุฏ ุจุนุฏุงู ุงุฒ Django admin ุงุณุชูุงุฏู ฺฉูุฏ")
    print()

def main():
    """ุงุฌุฑุง ุงุตู ุงุณฺฉุฑูพุช"""
    try:
        with transaction.atomic():
            create_regions()
            create_categories()
            create_sample_users()
            create_sample_markets()
            create_sample_products()
        
        print("="*80)
        print("๐ ุงุณฺฉุฑูพุช ุจุง ููููุช ุชฺฉูู ุดุฏ!")
        print("="*80)
        
        # ููุงุด ุขูุงุฑ ููุง
        print("\n๐ ุขูุงุฑ ููุง:")
        print(f"  ฺฉุดูุฑูุง: {Country.objects.count()}")
        print(f"  ุงุณุชุงูโูุง: {Province.objects.count()}")
        print(f"  ุดูุฑูุง: {City.objects.count()}")
        print(f"  ฺฏุฑููโูุง: {Group.objects.count()}")
        print(f"  ุฏุณุชูโูุง: {Category.objects.count()}")
        print(f"  ุฒุฑุฏุณุชูโูุง: {SubCategory.objects.count()}")
        print(f"  ฺฉุงุฑุจุฑุงู: 0 (ูุงุฒ ุจู migration)")
        print(f"  ุจุงุฒุงุฑูุง: 0 (ูุงุฒ ุจู ฺฉุงุฑุจุฑ)")
        print(f"  ูุญุตููุงุช: 0 (ูุงุฒ ุจู ุจุงุฒุงุฑ)")
        
    except Exception as e:
        print(f"โ ุฎุทุง ุฏุฑ ุงุฌุฑุง ุงุณฺฉุฑูพุช: {e}")
        raise

if __name__ == "__main__":
    main()
