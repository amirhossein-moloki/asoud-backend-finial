# خلاصه تغییرات امنیتی

این مستند خلاصه‌ای از تغییرات اعمال‌شده برای افزایش امنیت پروژه از طریق فیلتر کردن کوئری‌ها بر اساس کاربر لاگین‌کرده (`request.user`) را ارائه می‌دهد. هدف اصلی این تغییرات، جلوگیری از دسترسی غیرمجاز به داده‌های حساس کاربران و اطمینان از اینکه هر کاربر فقط به اطلاعات مربوط به خود دسترسی دارد، بوده است.

## تغییرات اصلی

1.  **بررسی جامع ویوها**: تمام ویوهای پروژه در پوشه‌ی `apps` برای شناسایی کوئری‌هایی که فاقد فیلتر بر اساس کاربر بودند، بررسی شدند.

2.  **امن‌سازی اطلاعات بانکی**:
    -   `BanksListView` در اپ `users`: این ویو که قبلاً به هر کاربری اجازه‌ی مشاهده‌ی لیست تمام بانک‌ها را می‌داد، اصلاح شد تا فقط به کاربران احرازهویت‌شده اجازه‌ی دسترسی بدهد و تنها اطلاعات بانکی مربوط به خودشان را نمایش دهد.
    -   `BankCardView` در اپ `flutter`: این ویو نیز که به هر کاربری اجازه می‌داد تا با داشتن شناسه، اطلاعات هر کارت بانکی را مشاهده کند، امن شد و এখন فقط به مالک کارت اجازه‌ی دسترسی می‌دهد.

3.  **کنترل دسترسی به داده‌های تحلیلی (Analytics)**:
    -   ویوهای مربوط به تحلیل داده‌ها در اپ `analytics` اصلاح شدند تا سطح دسترسی کاربران را کنترل کنند.
    -   کاربران عادی فقط به داده‌های تحلیلی مربوط به خودشان دسترسی دارند.
    -   مالکان مارکت‌ها می‌توانند به داده‌های مربوط به مارکت خودشان دسترسی داشته باشند.
    -   ادمین‌ها به تمام داده‌ها دسترسی کامل دارند.

4.  **ریفکتور و اصلاح تست‌ها**:
    -   در حین بررسی، مشخص شد که مدل `ProductAnalytics` به `ItemAnalytics` تغییر نام داده است. تمام بخش‌های کد، از جمله سرویس‌ها، مدل‌های یادگیری ماشین و تست‌ها، برای هماهنگی با این تغییر نام، اصلاح شدند.
    -   محیط اجرای تست تکمیل و مشکلات مربوط به بسته‌های نصب‌نشده برطرف گردید تا تمام تست‌ها با موفقیت پاس شوند.

این تغییرات به طور قابل توجهی امنیت پروژه را افزایش داده و از داده‌های کاربران در برابر دسترسی‌های غیرمجاز محافظت می‌کنند.
