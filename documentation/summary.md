تغییرات امنیتی پروژه

در این مرحله تمرکز اصلی روی امنیت بوده و هدف این بوده که هر کاربر فقط به اطلاعات خودش دسترسی داشته باشه و هیچ داده‌ای از دسترس دیگران خارج نشه. برای این کار، بیشتر تغییرات روی فیلتر کردن کوئری‌ها بر اساس کاربر لاگین‌شده (request.user) انجام شد.

کارهای اصلی که انجام شد

بررسی کامل ویوها
همه ویوهای پروژه در پوشه apps بررسی شدند تا کوئری‌هایی که بدون فیلتر کاربر بودند پیدا و اصلاح شوند.

امن کردن اطلاعات بانکی

لیست بانک‌ها (BanksListView): قبلاً هر کاربر می‌توانست لیست همه بانک‌ها را ببیند، حالا فقط اطلاعات بانکی خودش را می‌بیند.

اطلاعات کارت بانکی (BankCardView): پیش‌تر با داشتن شناسه کارت، هر کسی می‌توانست اطلاعات کارت دیگری را ببیند؛ الان فقط مالک کارت به آن دسترسی دارد.

کنترل دسترسی به داده‌های تحلیلی (Analytics)

کاربران عادی فقط داده‌های خودشان را می‌بینند.

مالکان مارکت‌ها داده‌های مربوط به مارکت خودشان را می‌بینند.

ادمین‌ها به همه داده‌ها دسترسی دارند.

اصلاح و بهبود تست‌ها

نام مدل ProductAnalytics به ItemAnalytics تغییر کرده و همه بخش‌های کد و تست‌ها با این تغییر هماهنگ شدند.

مشکلات محیط تست و بسته‌های نصب‌نشده رفع شدند تا همه تست‌ها بدون مشکل اجرا شوند.

این تغییرات باعث شدند پروژه امن‌تر شود و داده‌های کاربران در برابر دسترسی غیرمجاز محافظت شوند.

بهبود معماری و کد

در کنار امنیت، یک بازآرایی جدی هم در اپلیکیشن‌های market و item انجام شد تا کد خواناتر، قابل اعتمادتر و سریع‌تر شود.

تغییرات اصلی

اضافه شدن لایه سرویس (Service Layer)
منطق اصلی برنامه از ویوها جدا شد و به کلاس‌های سرویس منتقل شد.
مزایا:

ویوها فقط کار مدیریت درخواست و پاسخ را انجام می‌دهند.

منطق تجاری راحت‌تر قابل استفاده مجدد است.

تست‌ها ساده‌تر و قابل اعتمادتر شدند.

مدیریت خطای یکپارچه
یک سیستم مرکزی برای مدیریت خطاها پیاده شد تا همه APIها پاسخ‌های یکنواخت و استاندارد بدهند.
مزایا:

خطاها به شکل یکسان نمایش داده می‌شوند.

کدهای تکراری حذف شدند.

خطاهایی مثل پیدا نشدن رکورد به درستی به پاسخ 404 تبدیل می‌شوند.

بهینه‌سازی کوئری‌ها
با select_related و prefetch_related تعداد کوئری‌ها کاهش پیدا کرد و مشکل N+1 Query حل شد.
مزایا:

سرعت APIها افزایش چشمگیر داشته است.

بار روی پایگاه داده کاهش یافته است.

رفع باگ‌ها و مشکلات منطقی

مشکلاتی مثل ذخیره نشدن رکورد تخفیف و حذف شدن اعتبارسنجی در آپدیت مارکت برطرف شدند.

پاسخ APIها همیشه وضعیت نهایی و درست منابع را برمی‌گردانند.

این تغییرات باعث شدند پروژه پایدارتر، قابل توسعه‌تر و سریع‌تر شود و آماده آینده باشد.
